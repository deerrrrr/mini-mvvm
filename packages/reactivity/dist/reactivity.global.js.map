{"version":3,"file":"reactivity.global.js","sources":["../../shared/src/index.ts","../src/effect.ts","../src/baseHandlers.ts","../src/reactiveApi.ts","../src/ref.ts","../src/computed.ts"],"sourcesContent":["// 公共方法\r\nexport function isObject(target) {\r\n  return typeof target === 'object' && target != null\r\n}\r\n// 合并对象\r\nexport const extend = Object.assign\r\n// 判断\r\nexport const isArray = Array.isArray\r\nexport const isFunction = (val) => typeof val === 'function'\r\nexport const isNumber = (val) => typeof val === 'number'\r\nexport const isString = (val) => typeof val === 'string'\r\n\r\n// 判断数组的key是不是整数\r\nexport const isIntegerKey = (key) => parseInt(key) + '' === key\r\n// 对象中是否有这个属性\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\nexport const hasOwn = (\r\n  val: object,\r\n  key: string | symbol\r\n): key is keyof typeof val => hasOwnProperty.call(val, key)\r\n\r\nexport const hasChange = (val, oldVal) => val !== oldVal\r\n\r\nexport * from './shapeFlag'\r\n","import { isArray, isIntegerKey } from \"@vue/shared\"\r\nimport { TriggerOpTypes } from \"./operations\"\r\n\r\nexport function effect(fn, options: any = {}) {\r\n  const effect = createReactEffect(fn, options)\r\n  // 判断\r\n  if (!options.lazy) {\r\n    effect()  // 默认执行\r\n  }\r\n  return effect\r\n}\r\n\r\nlet uid = 0 // 用于区分不同的effect\r\nlet activeEffect //保存当前的effect 给Track可以用\r\nconst effectStack = [] //解决嵌套问题，栈结构\r\n\r\nfunction createReactEffect(fn, options) {\r\n  const effect = function reactiveEffect() {\r\n    if (!effectStack.includes(effect)) {  // 不重复\r\n      // 为解决嵌套问题\r\n      try {\r\n        effectStack.push(effect)\r\n        activeEffect = effect\r\n        return fn() // 执行用户的方法\r\n      } finally {\r\n        effectStack.pop()\r\n        activeEffect = effectStack[effectStack.length - 1]\r\n      }\r\n    }\r\n  }\r\n  effect.id = uid++ // 区别effect\r\n  effect._isEffect = true // 是不是响应式的effect\r\n  effect.raw = fn // 保存用户的方法\r\n  effect.options = options // 保存用户的属性\r\n  return effect\r\n}\r\n\r\n// 收集effect\r\nlet targetMap = new WeakMap()\r\nexport function Track(target, type, key) {\r\n  if (activeEffect === undefined) { // 没有在effect中使用\r\n    return\r\n  }\r\n  let depMap = targetMap.get(target)\r\n  if (!depMap) { // 没有这个对象\r\n    targetMap.set(target, (depMap = new Map)) // 添加值\r\n  }\r\n  let dep = depMap.get(key)\r\n  if (!dep) { // 没有属性\r\n    depMap.set(key, (dep = new Set))\r\n  }\r\n  if (!dep.has(activeEffect)) {\r\n    dep.add(activeEffect) //收集effect\r\n  }\r\n\r\n}\r\n\r\n\r\n// 触发更新\r\nexport function trigger(target, type, key?, newValue?, oldValue?) {\r\n  const depsMap = targetMap.get(target)\r\n  if (!depsMap) {\r\n    return\r\n  }\r\n  let effectSet = new Set() // Set结构可以避免重复\r\n  const add = (effectAdd) => {\r\n    if (effectAdd) {\r\n      effectAdd.forEach(effect => effectSet.add(effect))\r\n    }\r\n  }\r\n\r\n  if (key === 'length' && isArray(target)) {\r\n    depsMap.forEach((dep, key) => {\r\n      if (key === 'length' || key >= newValue) {\r\n        add(dep)\r\n      }\r\n    })\r\n  } else {\r\n    // 对象\r\n    if (key !== undefined) {\r\n      add(depsMap.get(key))\r\n    }\r\n    // 数组\r\n    switch (type) {\r\n      case TriggerOpTypes.ADD:\r\n        if (isArray(target) && isIntegerKey(key)) {\r\n          add(depsMap.get('length'))\r\n        }\r\n    }\r\n\r\n  }\r\n  // 执行 触发effect\r\n  effectSet.forEach((effect: any) => {\r\n    if (effect.options.changeDirty) {// 不再次get不会执行effect\r\n      effect.options.changeDirty()\r\n    } else {\r\n      effect()\r\n    }\r\n  })\r\n}","import { extend, hasChange, hasOwn, isArray, isIntegerKey, isObject } from \"@vue/shared\"\r\nimport { Track, trigger } from \"./effect\"\r\nimport { TrackOpType, TriggerOpTypes } from \"./operations\"\r\nimport { reactive, readonly } from \"./reactiveApi\"\r\n\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n  return function get(target, key, receiver) {\r\n    const res = Reflect.get(target, key, receiver)\r\n    if (!isReadonly) { // 不是只读\r\n      // 收集依赖effect\r\n      Track(target, TrackOpType.GET, key)\r\n    }\r\n    if (shallow) {// 浅\r\n      return res\r\n    }\r\n\r\n    // 懒代理+递归\r\n    if (isObject(res)) {\r\n      return isReadonly ? readonly(res) : reactive(res)\r\n    }\r\n    return res\r\n  }\r\n}\r\n\r\nfunction createSetter(shallow = false) {\r\n  return function set(target, key, value, receiver) {\r\n    // 注意：数组/对象 添加/修改值\r\n    // 获取老值\r\n    const oldValue = target[key]\r\n\r\n    // 判断\r\n    let haskey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key)\r\n\r\n    const result = Reflect.set(target, key, value, receiver)\r\n    \r\n    if (!haskey) { // 没有 新增\r\n      trigger(target, TriggerOpTypes.ADD, key, value)\r\n    } else { // 修改\r\n      if (hasChange(value, oldValue)) {\r\n        trigger(target, TriggerOpTypes.SET, key, value, oldValue)\r\n      }\r\n    }\r\n    return result\r\n  }\r\n}\r\n// get\r\nconst get = createGetter()\r\nconst shallowGet = createGetter(false, true)\r\nconst readonlyGet = createGetter(true)\r\nconst shallowReadonlyGet = createGetter(true, true)\r\n\r\n// set\r\nconst set = createSetter()\r\nconst shallowSet = createSetter(true)\r\n\r\nexport const reactiveHandlers = {\r\n  get,\r\n  set\r\n}\r\nexport const shallowReactiveHandlers = {\r\n  get: shallowGet,\r\n  set: shallowSet\r\n}\r\n\r\nlet readonlyObj = {\r\n  set: (target, key) => {\r\n    console.warn(`set ${target} on key ${key} failed`);\r\n  }\r\n}\r\n\r\nexport const readonlyHandlers = extend({\r\n  get: readonlyGet\r\n}, readonlyObj)\r\nexport const shallowReadonlyHandlers = extend({\r\n  get: shallowReadonlyGet,\r\n}, readonlyObj)","import { isObject } from \"@vue/shared\"\r\nimport {\r\n  reactiveHandlers,\r\n  shallowReactiveHandlers,\r\n  readonlyHandlers,\r\n  shallowReadonlyHandlers\r\n} from \"./baseHandlers\"\r\nexport function reactive(target) {\r\n  return createReactObj(target, false, reactiveHandlers)\r\n}\r\n\r\nexport function shallowReactive(target) {\r\n  return createReactObj(target, false, shallowReactiveHandlers)\r\n}\r\n\r\nexport function readonly(target) {\r\n  return createReactObj(target, true, readonlyHandlers)\r\n}\r\n\r\nexport function shallowReadonly(target) {\r\n  return createReactObj(target, true, shallowReadonlyHandlers)\r\n}\r\n\r\n// 实现代理的核心\r\n// ！！优化 防止重复代理\r\nconst reactiveMap = new WeakMap() // key必须是对象，自动的垃圾回收\r\nconst readonlyMap = new WeakMap()\r\n// 柯里化：根据不同的参数\r\nfunction createReactObj(target, isReadonly, baseHandlers) {\r\n  // 如果不是对象\r\n  if (!isObject(target)) {\r\n    return target\r\n  }\r\n  // 优化\r\n  const proxymap = isReadonly ? readonlyMap : reactiveMap\r\n  const proxyEs = proxymap.get(target) // 有\r\n  if (proxyEs) {\r\n    return proxyEs\r\n  }\r\n  const proxy = new Proxy(target, baseHandlers)\r\n  proxymap.set(target, proxy) // 存入\r\n  return proxy\r\n}","import { Track, trigger } from \"./effect\"\r\nimport { TrackOpType, TriggerOpTypes } from \"./operations\"\r\nimport { hasChange, isArray } from \"@vue/shared\"\r\n\r\nexport function ref(target) {\r\n  return createRef(target)\r\n}\r\n\r\nexport function shallowRef(target) {\r\n  return createRef(target, true)\r\n}\r\n\r\n// 创建类\r\nclass RefImpl {\r\n  // 属性\r\n  public _v_isRef = true // 表识为ref\r\n  public _value // 声明\r\n  constructor(public rawValue, public shallow) {\r\n    this._value = rawValue // 用户传入的值\r\n  }\r\n  // 类的属性访问器\r\n  get value() {\r\n    Track(this, TrackOpType.GET, 'value') // 收集依赖\r\n    return this._value\r\n  }\r\n  set value(newVal) {\r\n    if (hasChange(newVal, this._value)) {\r\n      this._value = newVal\r\n      this.rawValue = newVal\r\n      trigger(this, TriggerOpTypes.SET, 'value', newVal) // 触发更新\r\n    }\r\n  }\r\n}\r\n\r\nfunction createRef(rawValue, shallow = false) {\r\n  // 返回实例对象\r\n  return new RefImpl(rawValue, shallow)\r\n}\r\n\r\n// 实现toRef\r\nexport function toRef(target, key) {\r\n  return new ObjectRefImpl(target, key)\r\n}\r\n\r\nclass ObjectRefImpl {\r\n  public __v_isRef = true\r\n  constructor(public target, public key) { }\r\n  get value() {\r\n    return this.target[this.key]\r\n  }\r\n  set value(newVal) {\r\n    this.target[this.key] = newVal\r\n  }\r\n}\r\n\r\n// 实现toRefs\r\nexport function toRefs(target) {\r\n  // 遍历所有属性\r\n  let ret = isArray(target) ? new Array(target.length) : {}\r\n  for (let key in target) {\r\n    ret[key] = toRef(target, key)\r\n  }\r\n  return ret\r\n}","import { isFunction } from \"@vue/shared\";\r\nimport { effect } from \"./effect\";\r\n\r\n// 传入函数or对象\r\nexport function computed(getterOrOptions) {\r\n  // 处理数据\r\n  let getter; // 获取\r\n  let setter; // 设置数据\r\n  if (isFunction(getterOrOptions)) { // 函数\r\n    getter = getterOrOptions\r\n    setter = () => {\r\n      console.warn('computed value must be readonly');\r\n    }\r\n  } else { // 对象\r\n    getter = getterOrOptions.get\r\n    setter = getterOrOptions.set\r\n  }\r\n  // 返回值\r\n  return new ComputedRefImpl(getter, setter)\r\n}\r\n\r\nclass ComputedRefImpl {\r\n  // 定义属性\r\n  public _dirty = true // 默认获取执行,缓存机制\r\n  public _value\r\n  public effect\r\n  constructor(getter, public setter) {\r\n    // 收集依赖\r\n    this.effect = effect(getter, {\r\n      lazy: true,\r\n      changeDirty: () => { // 修改数据时执行\r\n        if (!this._dirty) {\r\n          this._dirty = true\r\n        }\r\n      }\r\n    })\r\n  }\r\n  get value() {\r\n    // 获取执行\r\n    if (this._dirty) {\r\n      this._value = this.effect()\r\n      this._dirty = false // 缓存机制\r\n    }\r\n    return this._value\r\n  }\r\n  set value(newValue) {\r\n    this.setter(newValue)\r\n  }\r\n}"],"names":[],"mappings":"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"}